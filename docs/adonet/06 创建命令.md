## 一、命令与参数
### 01 DbCommand
建立与数据源的连接后，可以使用 DbCommand 对象来执行命令并从数据源中返回结果，可以使用命令构造函数之一为要使用的数据提供程序（Data Provider）创建命令。

每个 Data Provider 都具有一个 DbCommand 对象[^1] —— OleDbCommand、SqlCommand、OdbcCommand、OracleCommand。

[^1]: 适用于 OLE DB 的 OleDbCommand 对象；适用于 SQL Server 的 SqlCommand 对象；适用于 ODBC 的 OdbcCommand 对象；适用于 Oracle 的 OracleCommand 对象。

DbCommand 对象具有几个重要属性：

| 属性          | 说明                                                             |
|:------------- |:---------------------------------------------------------------- |
| `CommandText` | 获取或设置要在数据源中执行的 Transact-SQL 语句、表名或存储过程。 |
| `CommandType` | 获取或设置一个值，该值指示解释 CommandText 属性的方式。          |
| `Connection`  | 获取或设置 SqlCommand 的此实例使用的 SqlConnection。                                                                 |

CommandType 是一个枚举属性，可以通过该属性设置让命令字符串按何种规则被解释执行，枚举选项如下：

| 枚举项                      | 说明                                  |
|:--------------------------- |:------------------------------------- |
| `CommandType.Text`            | 定义要在数据源处执行的语句的 SQL 命令（默认） |
| `CommandType.StoredProcedure` | 存储过程名称                              |
| `CommandType.TableDirect`                 | 表的名称                              |

### 02 配置命令参数
通过提供类型检查和验证，命令对象可使用参数来将值传递给 SQL 语句或存储过程。

与命令文本不同，参数输入被视为文本值，而不是可执行代码。 这样可帮助抵御“SQL 注入”攻击，这种攻击的攻击者会将命令插入 SQL 语句，从而危及服务器的安全。参数化命令还可提高查询执行性能，因为它们可帮助数据库服务器将传入命令与适当的缓存查询计划进行准确匹配。除具备安全和性能优势外，参数化命令还提供一种用于组织传递到数据源的值的便捷方法。

[DbParameter](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.common.dbparameter) 对象可以通过使用其构造函数来创建，或者也可以通过调用 [DbParameterCollection](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.common.dbcommand.dbparametercollection) 集合的 `Add` 方法以将该对象添加到 [DbParameterCollection](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.common.dbparametercollection) 来创建。 `Add` 方法将构造函数实参或现有形参对象用作输入，具体取决于数据提供程序。

在添加参数时，您必须为输入参数以外的参数提供一个 [ParameterDirection](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.parameterdirection) 属性。 下表显示了可用于 `ParameterDirection` 枚举的 [ParameterDirection](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.parameterdirection) 值。
[Input](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.parameterdirection#system-data-parameterdirection-input) ： 该参数为输入参数。 这是默认值。
[InputOutput](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.parameterdirection#system-data-parameterdirection-inputoutput) ：该参数可执行输入和输出。
[Output](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.parameterdirection#system-data-parameterdirection-output)　：该参数为输出参数。
[ReturnValue](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.parameterdirection#system-data-parameterdirection-returnvalue)：该参数表示从某操作（如存储过程、内置函数或用户定义的函数）返回的值。

参数占位符的语法取决于数据源。 .NET Framework 数据提供程序以不同方式处理命名和指定参数和参数占位符。 此语法是针对某个特定的数据源自定义的，如下表所述。
[System.Data.SqlClient](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.sqlclient)：以 `@`_参数名_格式使用命名参数。
[System.Data.OleDb](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.oledb)：使用由问号 (?) 指示的位置参数标记。
[System.Data.Odbc](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.odbc)：使用由问号 (`?`) 指示的位置参数标记。
[System.Data.OracleClient](https://learn.microsoft.com/zh-cn/dotnet/api/system.data.oracleclient)：以 `:`_参数名_ （或 _参数名_）格式使用命名参数。